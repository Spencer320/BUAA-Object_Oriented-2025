# 官方包使用指南

## 输入输出说明

### 输入示例

```java
import static com.oocourse.library1.LibraryIO.SCANNER;
// 此处省略一些 import

class Sample {
    public static void main(String[] args) {
        Map<LibraryBookIsbn, Integer> bookList = SCANNER.getInventory();	// 获取图书馆内所有书籍ISBN号及相应副本数
        while (true) {
            LibraryCommand command = SCANNER.nextCommand();
            if (command == null) { break; }
            LocalDate today = command.getDate(); // 今天的日期
            if (command instanceof LibraryOpenCmd) {
                // 在开馆时做点什么
            } else if (command instanceof LibraryCloseCmd) {
                // 在闭馆时做点什么
            } else {
                LibraryReqCmd req = (LibraryReqCmd) command;
                LibraryReqCmd.Type type = req.getType(); // 指令对应的类型（查询/阅读/借阅/预约/还书/取书/归还）
                LibraryBookIsbn bookIsbn = req.getBookIsbn(); // 指令对应的书籍ISBN号（type-uid）
                LibraryBookId bookId = req.getBookId(); // 指令对应书籍编号（type-uid-copyId）
                String studentId = req.getStudentId(); // 指令对应的用户Id
                // 对指令进行处理
            }
        }
    }
}
```

> 注意若输入的命令中描述书籍使用的是“类别号-序列号”（如预约/借书/取书），则不能使用LibraryReqCmd中的getBookId方法，否则会抛出异常`ClassCastException`。请根据相应的指令格式使用合适的方法获取书籍信息。

### 输出示例

首先 import PRINTER: `import static com.oocourse.library1.LibraryIO.PRINTER;`

1. 响应开馆和闭馆指令（移动书籍）：`PRINTER.move(today /* 今天的日期 */, infos /* 含有 LibraryMoveInfo 的一个List容器，包含所有本次欲移动的书籍信息*/)`
2. 响应查询信用积分请求: `PRINTER.info(command /* 要响应的指令 */, value /* 信用积分 */)`。
3. 响应查询书记移动轨迹请求：`PRINTER.info(today /* 今天的日期 */, bookId /* 书籍的编号,类型为LibraryBookId */, traces/* 含有 LibraryTrace 的一个List容器，包含某次移动的相关信息*/)`。
4. 响应其他请求（失败）: `PRINTER.reject(command /* 要响应的指令 */)`。
6. 响应归还、还书请求（成功）: `PRINTER.accept(command /* 要响应的指令 */)`。
8. 响应其他请求（成功）(若指定了副本号）: `PRINTER.accept(command /* 要响应的指令 */， bookId /* 书籍的编号,类型为LibraryBookId */)`。

## 其他重要数据类说明

##### `LibraryBookIsbn`

书籍ISBN号信息。包含类别和序列号。

可用方法如下：

1. `LibraryBookIsbn.Type getType()` 用于获取书籍类别号。
2. `String getUid()` 用于获取书籍序列号。
3. `boolean isTypeA() isTypeB() isTypeC()` 用于判断数据是否为特定类型。
4. `boolean equals(Object o)` 用于比较书籍ISBN号是否完全一样。
5. `int hashCode()` 书籍类别号和序列号的混合 hash。
6. `String toString()` 书籍编号的格式化字符串。

##### `LibraryBookId`

书籍编号信息，**继承**自`LibraryBookIsbn`。包含类别号、序列号、**副本号**。

可用方法如下：

1. `LibraryBookIsbn.Type getType()` 用于获取书籍类别号。
2. `String getUid()` 用于获取书籍序列号。
3. `String getCopyId()` 用于获取书籍副本号。
4. `boolean isTypeA() isTypeB() isTypeC()` 用于判断数据是否为特定类型。
5. `boolean equals(Object o)` 用于比较书籍编号是否完全一样。
6. `int hashCode()` 书籍类别号、序列号、副本号的混合 hash。
7. `String toString()` 书籍编号的格式化字符串。

##### `LibraryBookState`

书籍状态信息，包含以下状态：

1. `BOOKSHELF` 书架
2. `APPOINTMENT_OFFICE`预约处
3. `BORROW_RETURN_OFFICE`借还处
6. `USER`用户（学生）

##### `LibraryMoveInfo`

用于输出移动信息的数据类。包含两种构造方式：

1. `LibraryMoveInfo(LibraryBookId bookId, LibraryBookState from, LibraryBookState to)`，该构造函数适用于移动到预约处以外的地方，参数依次为：移动的书籍，移动的起点名字，移动的终点名字。
2. `LibraryMoveInfo(LibraryBookId bookId, LibraryBookState from, LibraryBookState to, String reserveFor)`，该构造函数适用于移动到预约处，参数依次为：移动的书籍，移动的起点名字，移动的终点名字，为哪名学生预留（学生ID）。

该数据类的数据都有对应的 get 方法可以访问（但不能再次 set）。`from`和`to`参数可以传入对应的`String`类型名称。

##### `LibraryTrace`

用于输出移动轨迹信息的数据类。包含一个日期、一个起始状态、一个终止状态。日期类型为`LocalDate`，状态的数据类型为`LibraryBookState`。

该数据类的数据都有对应的get方法可以访问（但不能再次set）。

`equals`方法会比较所有字段是否相等。

##### `LibraryReqCmd`

`LibraryReqCmd`包含一个日期（继承自`LibraryCommand`）、一个用户ID、一个请求类型、一个书籍信息（ISBN号/书号）

包含如下方法：

1. `LibraryReqCmd.Type getType()` 用于获取请求的类型（查询/阅读/借阅/预约/还书/取书/归还）。
2. `String getStudentId()` 用于获取用户ID。
3. `LibraryBookId getBookIsbn()`用于获取书籍ISBN号。
4. `LibraryBookId getBookId()` 用于获取书籍编号。（若指令中书籍信息为ISBN号，则不能使用该方法，否则会抛出异常）
5. `boolean equals(Object o)` 只比较除日期外字段是否完全相等，不比较日期。注意两个类的实例之间不相等。
6. `int hashCode()` 将除日期外的3个字段混合进行hash，因此两个类的实例之间的hashCode是可以相等的。
7. `String toString()` 指令的格式化字符串。注意 LibraryReqCmd 有方法 getCommandString() 返回不带日期的指令字符串。